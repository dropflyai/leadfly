"use strict";(()=>{var e={};e.id=350,e.ids=[350],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3685:e=>{e.exports=require("http")},5687:e=>{e.exports=require("https")},5477:e=>{e.exports=require("punycode")},2781:e=>{e.exports=require("stream")},7310:e=>{e.exports=require("url")},9796:e=>{e.exports=require("zlib")},4029:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>h,originalPathname:()=>q,patchFetch:()=>f,requestAsyncStorage:()=>m,routeModule:()=>c,serverHooks:()=>g,staticGenerationAsyncStorage:()=>I,staticGenerationBailout:()=>y});var s={};t.r(s),t.d(s,{GET:()=>d,PUT:()=>p});var a=t(884),o=t(6132),n=t(1040),i=t(4556),u=t(5798);let l=(0,i.eI)("https://irvyhhkoiyzartmmvbxw.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlyY3loaGtvaXl6YXJ0bW12Ynh3Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTczMzg1MjE3NCwiZXhwIjoyMDQ5NDI4MTc0fQ.q30mqGJAOJ-Bk-2_sMqfWWTTpvhjRVpJP6KBM3GzgDo");async function d(e){try{let{searchParams:r}=new URL(e.url),t=r.get("user_id"),s=parseInt(r.get("page"))||1,a=parseInt(r.get("limit"))||50,o=r.get("min_score"),n=r.get("industry"),i=r.get("company_size");if(!t)return u.json({error:"User ID is required"},{status:400});let d=l.from("leads").select("*").eq("user_id",t).order("created_at",{ascending:!1}).range((s-1)*a,s*a-1);o&&(d=d.gte("lead_score",parseInt(o))),n&&(d=d.eq("industry",n)),i&&(d=d.eq("company_size",i));let{data:p,error:c,count:m}=await d;if(c)return console.error("Supabase query error:",c),u.json({error:"Failed to fetch leads"},{status:500});let{count:I}=await l.from("leads").select("*",{count:"exact",head:!0}).eq("user_id",t);return u.json({success:!0,leads:p||[],pagination:{page:s,limit:a,total:I||0,pages:Math.ceil((I||0)/a)}})}catch(e){return console.error("Get leads API error:",e),u.json({error:"Internal server error",message:e.message},{status:500})}}async function p(e){try{let r=await e.json(),{lead_id:t,status:s,notes:a}=r;if(!t)return u.json({error:"Lead ID is required"},{status:400});let o={};s&&(o.status=s),a&&(o.notes=a),o.updated_at=new Date().toISOString();let{data:n,error:i}=await l.from("leads").update(o).eq("id",t).select();if(i)return console.error("Supabase update error:",i),u.json({error:"Failed to update lead"},{status:500});return u.json({success:!0,message:"Lead updated successfully",lead:n[0]})}catch(e){return console.error("Update lead API error:",e),u.json({error:"Internal server error",message:e.message},{status:500})}}let c=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/leads/route",pathname:"/api/leads",filename:"route",bundlePath:"app/api/leads/route"},resolvedPagePath:"/Users/rioallen/Documents/DropFly/knowledge-engine/leadfly-integration/app/api/leads/route.js",nextConfigOutput:"",userland:s}),{requestAsyncStorage:m,staticGenerationAsyncStorage:I,serverHooks:g,headerHooks:h,staticGenerationBailout:y}=c,q="/api/leads/route";function f(){return(0,n.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:I})}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[271,228],()=>t(4029));module.exports=s})();